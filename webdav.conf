<VirtualHost *:80>
    ServerName storage.hiemercloud.de
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/webdav

    # Logging (moved to the VirtualHost context)
    ErrorLog /dev/stderr
    CustomLog /dev/stdout combined

    RemoteIPHeader X-Forwarded-For
    RemoteIPTrustedProxy 0.0.0.0

    # Public WebDAV Directory
    Alias /public /var/www/webdav/public
    <Directory /var/www/webdav/public>
        DAV On
        Options Indexes FollowSymLinks
        AllowOverride None
        DirectorySlash Off

        # Allow WebDAV methods (PUT, DELETE, MKCOL, etc.)
        <LimitExcept GET POST>
            Require all granted
        </LimitExcept>
    </Directory>

    # Restricted WebDAV Directory
    Alias /restricted /var/www/webdav/restricted
    <Directory /var/www/webdav/restricted>
        DAV On
        Options Indexes FollowSymLinks
        AllowOverride None
        DirectorySlash Off

        # Authentication (Digest Auth)
        AuthType Digest
        AuthName "Restricted"
        AuthUserFile /etc/apache2/webdav_credentials
        Require valid-user

        # Allow WebDAV methods (PUT, DELETE, MKCOL, etc.)
        <LimitExcept GET POST>
            Require valid-user
        </LimitExcept>
    </Directory>

    # Lock database for WebDAV locks
    DavLockDB /var/www/webdav/DavLock

</VirtualHost>
